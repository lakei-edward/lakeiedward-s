---
title: ã€ŒObject.createã€è¯¦è§£ ä¹‹ æºç å½»åº•åƒé€ 
date: 2022-12-02 16:55:42
permalink: /pages/c59462/
sidebar: auto
categories:
  - å‰ç«¯æŠ€æœ¯
tags:
  - JS
---

## Object.createæ˜¯ä»€ä¹ˆï¼Ÿ

MDNçš„å®šä¹‰ï¼šObject.create()æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½¿ç”¨ç°æœ‰çš„å¯¹è±¡æ¥ä½œä¸ºæ–°åˆ›å»ºå¯¹è±¡çš„åŸå‹ï¼ˆprototypeï¼‰ã€‚

## è¯­æ³•




```js
Object.create(proto, propertiesObject)
```
proto

- æ–°åˆ›å»ºå¯¹è±¡çš„åŸå‹å¯¹è±¡ã€‚

propertiesObject (å¯é€‰)

- å¦‚æœè¯¥å‚æ•°è¢«æŒ‡å®šä¸”ä¸ä¸º undefinedï¼Œåˆ™è¯¥ä¼ å…¥å¯¹è±¡çš„è‡ªæœ‰å¯æšä¸¾å±æ€§å°†ä¸ºæ–°åˆ›å»ºçš„å¯¹è±¡æ·»åŠ æŒ‡å®šçš„å±æ€§å€¼å’Œå¯¹åº”çš„å±æ€§æè¿°ç¬¦ã€‚è¿™äº›å±æ€§å¯¹åº”äº Object.defineProperties() çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯enumerableã€‚

## ä½¿ç”¨ `null` åŸå‹çš„å¯¹è±¡

1.ä»¥ `null` ä¸ºåŸå‹çš„å¯¹è±¡å­˜åœ¨ä¸å¯é¢„æœŸçš„è¡Œä¸ºï¼Œå› ä¸ºå®ƒæœªä» `Object.prototype` ç»§æ‰¿ä»»ä½•å¯¹è±¡æ–¹æ³•ï¼Œå³åˆ›å»ºå¯¹è±¡çš„åŸå‹ä¸ºç©ºã€‚

```js
const normalObj = {};   
const nullProtoObj = Object.create(null); 
```

![å›¾ç‰‡.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/045bc85ea2144cdd840df8a0c718f392~tplv-k3u1fbpfcp-watermark.image?)

2.ä½¿ç”¨nullåˆ›å»ºåŸå‹å¯¹è±¡çš„æ—¶å€™ï¼Œå†ä½¿ç”¨Objectçš„åŸå‹å¯¹è±¡çš„æ–¹æ³•å°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºåŸå‹ä¸Šä¸å­˜åœ¨è¯¥æ–¹æ³•äº†ï¼›

```js
const normalObj = {};   
const nullProtoObj = Object.create(null); 

normalObj.valueOf(); // {}
nullProtoObj.valueOf(); //error:nullProtoObj.valueOf is not a function
```

![å›¾ç‰‡.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5ee32f04930444f3b6b3ee705338ec74~tplv-k3u1fbpfcp-watermark.image?)

3.æˆ‘ä»¬å¯ä»¥ä¸ºä»¥ null ä¸ºåŸå‹çš„å¯¹è±¡æ·»åŠ  `toString` æ–¹æ³•ï¼Œç±»ä¼¼äºè¿™æ ·ï¼š

```js
nullProtoObj.toString = Object.prototype.toString;
console.log(nullProtoObj); // toString:Â Æ’Â toString()
```
ä¸å¸¸è§„çš„å¯¹è±¡ä¸åŒï¼Œ`nullProtoObj` çš„ `toString` æ–¹æ³•æ˜¯è¿™ä¸ªå¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè€Œéç»§æ‰¿è‡ªå¯¹è±¡çš„åŸå‹ã€‚è¿™æ˜¯å› ä¸º `nullProtoObj` â€œæ²¡æœ‰â€åŸå‹ï¼ˆ`null`ï¼‰ã€‚

4.åœ¨å®è·µä¸­ï¼ŒObject.prototypeåŸå‹çš„è‡ªæœ‰å±æ€§å¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬åˆ¤æ–­é”™è¯¯

```js
const ages = { alice: 18, bob: 27 };

function hasPerson(name) {
  return name in ages;
}

function getAge(name) {
  return ages[name];
}

hasPerson("hasOwnProperty") // true
getAge("toString") // [Function: toString]
```
ä½¿ç”¨`null`åˆ›å»ºå¯¹è±¡åˆ™æ¶ˆé™¤äº†è¿™ç§æ½œåœ¨çš„é—®é¢˜

```js
const ages = Object.create(null, {
  alice: { value: 18, enumerable: true },
  bob: { value: 27, enumerable: true },
});

hasPerson("hasOwnProperty") // false
getAge("toString") // undefined
```

## Object.createçš„ä½¿ç”¨ç¤ºä¾‹


```js
let o = Object.create(
  {},
  {
    p: {
      value: 42,
      writable: false,//å¯å†™çš„ -- ä¸ºtrueæ—¶oå¯¹è±¡çš„å±æ€§å€¼å¯æ”¹å˜
      enumerable: false,//å¯æšä¸¾çš„ -- ä¸ºtrueæ—¶oå¯¹è±¡çš„å±æ€§å¯è¢«éå†
      configurable: false,//å¯é…ç½®çš„ -- ä¸ºtrueæ—¶oå¯¹è±¡çš„å±æ€§å¯è¢«åˆ é™¤
    },
  }
);

o.p = 24; //{p: 42}
delete o.p; //{p: 42}
for (let i in o) {
  console.log(i);// i æ²¡æœ‰è¾“å‡º
}
```

## æºç -ç¤ºä¾‹

```js
/* æºç 
 ------------------------------*/
Object.myCreate = function (proto, propertiesObject = undefined) {
  if (propertiesObject === null) {
    // è¿™é‡Œæ²¡æœ‰åˆ¤æ–­propertiesObject æ˜¯å¦æ˜¯åŸå§‹åŒ…è£…å¯¹è±¡
    throw "Cannot convert undefined or null to object at Function.create (<anonymous>)";
  } else {
    function Fn() {}
    Fn.prototype = proto;
    let obj = new Fn();
    if (proto === null) {
      obj.__proto__ = null; 
    }
    if (propertiesObject !== undefined) {
      Object.defineProperties(obj, propertiesObject);
    }
    return obj;
  }
};

/* ç¤ºä¾‹
 ------------------------------*/
const throwError = Object.myCreate({}, null); //throwError

const obj1 = Object.myCreate(null);
console.log(obj1);

const obj2 = Object.myCreate({ age: 18 });
console.log(obj2); //  obj2çš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡æ˜¯age: 18

const obj3 = Object.myCreate(
  { age: 18 },
  {
    isTrue: {
      value: true,
      enumerable: true,
    },
  }
);
console.log(obj3); // isTrue: true, obj3çš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡æ˜¯age: 18
```

## Object.createçš„å…¼å®¹æ€§

![å›¾ç‰‡.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/410ebc25d51246d49f6547685e31f4bf~tplv-k3u1fbpfcp-watermark.image?)

> å¦‚æœ‰å°ä¼™ä¼´å‘ç°é”™è¯¯ä¹‹å¤„æ¬¢è¿æŒ‡æ­£ğŸ¤š