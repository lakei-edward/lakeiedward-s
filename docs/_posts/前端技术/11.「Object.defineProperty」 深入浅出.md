---
title: ã€ŒObject.definePropertyã€ æ·±å…¥æµ…å‡º
date: 2022-12-02 16:56:16
permalink: /pages/8d4358/
sidebar: auto
categories:
  - å‰ç«¯æŠ€æœ¯
tags:
  - JS
---

## Object.definePropertyæ˜¯ä»€ä¹ˆï¼Ÿ

**`Object.defineProperty()`** æ–¹æ³•ä¼šç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„ç°æœ‰å±æ€§ï¼Œå¹¶è¿”å›æ­¤å¯¹è±¡ã€‚


## è¯­æ³•

```
Object.defineProperty(obj, prop, descriptor)
```
 **å‚æ•°**

-   `obj`

    è¦å®šä¹‰å±æ€§çš„å¯¹è±¡ã€‚

-   `prop`

    è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„åç§°ã€‚

-   `descriptor`

    è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§æè¿°ç¬¦ã€‚

 **è¿”å›å€¼**

- è¢«ä¼ é€’ç»™å‡½æ•°çš„å¯¹è±¡ã€‚

## ç¤ºä¾‹

### è¿”å›å€¼


```js
 let obj1 = {
   name: "å¼ ä¸‰",
 };
 Object.defineProperty(obj1, "name", {
   value: "æå››",
 });
 console.log(obj1);//{name: 'æå››'}
```
### æ·»åŠ æ–°çš„å±æ€§

- configurable å¯é…ç½®çš„
- writable å¯å†™çš„
- enumerable å¯æšä¸¾çš„

è¿™ä»¨å±æ€§æ˜¯é»˜è®¤æ˜¯`false`çš„ è®©æˆ‘ä»¬å…ˆæ¥æ¼”ç¤ºä¸€éã€‚

```js
let obj1 = {
  name: "å¼ ä¸‰",
};
Object.defineProperty(obj1, "age", {
  value: 24,
  configurable: false,
  writable: false,
  enumerable: false,
});
console.log(obj1); //{name: 'å¼ ä¸‰', age: 24}
//ä¿®æ”¹å±æ€§
obj1.age = 26;
console.log(obj1); //{name: 'å¼ ä¸‰', age: 24}
//åˆ é™¤å±æ€§
delete obj1.age;
console.log(obj1); //{name: 'å¼ ä¸‰', age: 24}
//for in éå†
for (let i in obj1) {
  console.log(obj1[i]); //åªæ‰“å°äº†å¼ ä¸‰
}
//é€šè¿‡Object.key()æ¥è·å–é”® è·å–ä¸åˆ°
console.log(Object.keys(obj1)); //['name']

//å¦‚æœæˆ‘ä»¬å°±æ˜¯æƒ³è·å–é‡Œé¢çš„å±æ€§åæ€ä¹ˆåŠå‘¢  å¯ä»¥é€šè¿‡getOwnPropertyNamesæ¥è·å–è‡ªèº«çš„å±æ€§
console.log(Object.getOwnPropertyNames(obj1)); //['name', 'age']

//æˆ–è€…æˆ‘ä»¬ç”¨æ¥åˆ¤æ–­è‡ªèº«æœ‰æ²¡æœ‰ageè¿™ä¸ªå±æ€§ å¯ä»¥é€šè¿‡hasOwnPropertyæ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨
console.log(obj1.hasOwnProperty("age")); //true
```
è¿™ä»¨è®¾ç½®ä¸ºtrueé‡å¤ä¸Šé¢æ“ä½œï¼Œå‘ç°éƒ½æ˜¯ä½ æƒ³è¦çš„ç»“æœäº†ã€‚


### getå’Œset
å› ä¸º`get`å’Œ`set`çš„åŠ«æŒ å¢åŠ äº†æ“ä½œçš„çµæ´»æ€§ï¼Œå¯ä»¥åœ¨`getã€set`æ–¹æ³•é‡Œè¿›è¡Œä¸€äº›æ“ä½œã€‚

```js
let obj1 = {
  name: "å¼ ä¸‰",
};
let value = null;
Object.defineProperty(obj1, "name", {
  get() {
    console.log("get!");
    return value;
  },
  set(newVal) {
    console.log("set!");
    value = newVal;
  },
});
obj1.name;//get!
obj1.name = "æå››";// 'set!'
console.log(obj1.name); //æå››
```
ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå­˜æ¡£å¯¹è±¡ã€‚å½“è®¾ç½®temperature å±æ€§æ—¶ï¼Œarchive æ•°ç»„ä¼šæ”¶åˆ°æ—¥å¿—æ¡ç›®ã€‚

```js
function Archiver() {
  var temperature = null;
  var archive = [];
  Object.defineProperty(this, "temperature", {
    get() {
      return temperature;
    },
    set(value) {
      temperature = value;
      archive.push(temperature);
    },
  });
  this.getArchive = function () {
    return archive;
  };
}
var arc = new Archiver();
arc.temperature = 11;
arc.temperature = 12;
console.log(arc.getArchive()); // [11, 12]
```

### æä½œç¬¦å­˜åœ¨å¼‚å¸¸çš„æƒ…å†µ

å¦‚æœä¸€ä¸ªæè¿°ç¬¦åŒæ—¶æ‹¥æœ‰`value` æˆ– `writable` å’Œ `get` æˆ– `set` é”®ï¼Œåˆ™ä¼šäº§ç”Ÿä¸€ä¸ªå¼‚å¸¸ã€‚

- ä¹Ÿå°±è¯´`value`æˆ–`writable`å‡ºç°çš„åœ°æ–¹ï¼Œ`get`æˆ–`set`éƒ½ä¸èƒ½å‡ºç°
- `get`æˆ–`set`å‡ºç°çš„åœ°æ–¹ï¼Œ`value`æˆ–`writable`éƒ½ä¸èƒ½å‡ºç°
- å¦åˆ™å°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸

```js
let obj1 = {};
Object.defineProperty(obj1, "name", {
  value: "å¼ ä¸‰",
  get() {},
});
//Uncaught TypeError: Invalid property descriptor. Cannot both specify accessors and a value or writable attribute
```

### ç»§æ‰¿

ä¸€ä¸ªä¸å¯å†™çš„å±æ€§è¢«ç»§æ‰¿çš„è¯ ç»§æ‰¿è¿‡æ¥ä¹‹åè¿˜æ˜¯ä¸å¯å†™!

```js
function Person() {}
Person.prototype.name = "å¼ ä¸‰";
Object.defineProperty(Person.prototype, "age", {
  writable: false,
  value: 8,
});
let p1 = new Person();
p1.name = "æå››";
p1.age = 10;
p1.hobby = "Games";
console.log(p1); //{name: 'æå››', hobby: 'Games'}
```

## ä¸Object.definePropertiesçš„åŒºåˆ«

### Object.definePropertiesè¯­æ³•
è¯¥æ–¹æ³•ç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰æ–°çš„å±æ€§æˆ–ä¿®æ”¹ç°æœ‰å±æ€§ï¼Œå¹¶è¿”å›è¯¥å¯¹è±¡ï¼Œå’Œ`Object.defineProperty`ç±»ä¼¼ï¼Œä½†å‚æ•°ä¸åŒ
```
Object.defineProperties(obj, props)
```

### åŒºåˆ«

Object.definePropertieså¯ä»¥æ“ä½œä¸€ä¸ªå¯¹è±¡æ–°å¢æˆ–ä¿®æ”¹å¤šä¸ªå±æ€§

```js
let sample1 = {};
Object.defineProperties(sample1, {
  prop1: {
    value: "Jerry",
    configurable: false,
    writable: false,
    enumerable: false,
  },
  prop2: {
    value: "Tom",
    configurable: false,
    writable: false,
    enumerable: false,
  },
});
sample1.prop1 = "Nacy";
sample1.prop2 = "Nacy";
console.log(sample1.prop1); //Jerry
console.log(sample1.prop2); //Tom
```



## ç»å…¸é¢è¯•é¢˜

è¯·åœ¨æ§åˆ¶å°æ‰“å°'ä»Šå¤©åƒğŸ”'
```js
if (a === 1 && a === 2 && a === 3) {
  console.log("success");
}
```

<details>
<summary>ç­”æ¡ˆ</summary>

```js
let i = 1;
Object.defineProperty(window, "a", {
  get() {
    return i++;
  },
});

æ¯æ¬¡è°ƒç”¨açš„æ—¶å€™éƒ½ä¼šèµ°åˆ°getæ–¹æ³•é‡Œé¢ï¼Œè¿”å›i++

if (a === 1 && a === 2 && a === 3) {
  console.log("ä»Šå¤©åƒğŸ”");
}
```
</details>
